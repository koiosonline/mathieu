import('https://www.mgatsonides.online:5001/mathieu/koios_youtube.mjs').then(x=> x.sleep(1000).then (x=>console.log("hi")))
import('https://www.mgatsonides.online:5001/mathieu/koios_youtube.mjs').then(x=> x.GetYouTubePlaylists().then (x=>console.log("hi")))
import('https://gpersoon.com/koios/gerard/koios_util.mjs').then(x=> x.getYouTubePlaylists().then (x=>console.log("hi")))

getYouTubePlaylists
var test
import('https://www.mgatsonides.online:5001/mathieu/koios_youtube.mjs').then(x=> test =x);
test.GetYouTubePlayListItems("PL_tbH3aD86KtKGgHhoSTwLARW-Ke5rLzt").then(x=> console.log(x))
PL_tbH3aD86KtKGgHhoSTwLARW-Ke5rLzt


instant test command
import('https://www.mgatsonides.online:5001/mathieu/koios_youtube.mjs').then(x=> x.forIPFSexport().then(y=> console.log(y)));


import('https://www.mgatsonides.online:5001/mathieu/koios_ipfs.mjs').then(x=> x.uploadToIpfs().then(y=> console.log(y)));


import('https://www.mgatsonides.online:5001/mathieu/koios_ipfs.mjs').then(x=> x.setupIPFS().then(y=> console.log(y)));





export async function GetYouTubePlayListItems(idInput) {

    const queryString = window.location.search;
    //console.log(`In GetYouTubePlayListItems queryString=${queryString}`);

    const urlParams = new URLSearchParams(queryString);
    //console.log(urlParams);

    let playlistId = urlParams.get('playlistId') || idInput;
    // level 1 "PL_tbH3aD86Kt-vJy4Q-rvZtXDmrLMG1Ef";


    console.log(`playlistId=${playlistId}`);


    var nextPageToken="";
    var resultlist=[];
    await LoadGapi();
    do {
        var list=await gapi.client.youtube.playlistItems.list({
          "part": "snippet", // contentDetails
          "playlistId": playlistId,
          "maxResults": 50,
          "pageToken" : nextPageToken
        });
        nextPageToken = list.result.nextPageToken;
        //console.log(list);
        //console.log(`GetYouTubePlayListItems: next ${list.result.items.length} records`);
        //console.log(nextPageToken);
        var idlist="";

        var resultlistindex=resultlist.length;
        for (var i=0;i<list.result.items.length;i++) {
            var snippet=list.result.items[i].snippet;
            var result={};
            var deslines = snippet.description.split("\n"); // find ___ChapterTitles___
            if (deslines[0] && deslines[0].includes("___")) {
               result.title   = deslines[0].replace(/_/g,"");
               result.chapter = true;
               resultlist.push(result);
            }

            result={};
            idlist +=(idlist?",":"")+snippet.resourceId.videoId;
            //result.id    = list.result.items[i].id;
            result.title        = snippet.title;
            result.description  = snippet.description;
            result.thumbnail    = snippet.thumbnails.default.url;
            result.videoid      = snippet.resourceId.videoId;
            result.chapter      = false;
            resultlist.push(result);
        }

        var list2=await gapi.client.youtube.videos.list({
            "part": "contentDetails",
            "id": idlist
        });

        //console.log(resultlistindex);
        for (var i=0;i<list2.result.items.length;i++) {
            while (resultlist[resultlistindex].chapter) // skip the chapters
                resultlistindex++;
            var contentDetails=list2.result.items[i].contentDetails;
            resultlist[resultlistindex].duration = moment.duration(contentDetails.duration).asSeconds();
            resultlistindex++;
        }
    } while (nextPageToken);
    //console.log(resultlist);
    return resultlist;
}


"PL_tbH3aD86Kt-vJy4Q-rvZtXDmrLMG1Ef"
